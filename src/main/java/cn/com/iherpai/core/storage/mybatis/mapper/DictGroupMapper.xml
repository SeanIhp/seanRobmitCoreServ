<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- namespace命名空间，作用就是对sql进行分类化管理，理解sql隔离 
注意：使用mapper代理方法开发，namespace有特殊重要的作用，namespace等于mapper接口地址
-->
<mapper namespace="cn.com.iherpai.core.storage.mybatis.mapper.DictGroupMapper">

	<resultMap type="cn.com.iherpai.core.storage.mybatis.orm.DictGroup" id="DictGroupFldsDefault">
		<id property="id" 					column="id" />
	    <result property="nid" 				column="nid" />
	    <result property="sid" 				column="sid" />
	    <result property="code" 			column="code" />
	    <result property="name" 			column="name" />
	    <result property="scode" 			column="scode" />
	    <result property="sname" 			column="sname" />
	    <result property="type" 			column="type" />
	    <result property="hasChild" 		column="has_child" />
	    <result property="level" 			column="level" />
	    <result property="sortno" 			column="sortno" />
	    <result property="parentId" 		column="parent_id" />
	    <result property="parentNid" 		column="parent_nid" />
	    <result property="parentSid" 		column="parent_sid" />
	    <result property="description" 		column="description" />
	    <result property="createTime" 		column="create_time" />
	    <result property="status" 			column="status" />
	</resultMap>

	<sql id="queryCommon">
		<if test="id != null">
			AND id = #{id} 
		</if>
		<if test="nid != null">
			AND nid = #{nid} 
		</if>
		<if test="sid != null">
			AND sid = #{sid} 
		</if>
		<if test="code != null">
			AND code = #{code} 
		</if>
		<if test="name != null">
			AND name = #{name} 
		</if>
		<if test="scode != null">
			AND scode = #{scode} 
		</if>
		<if test="sname != null">
			AND sname = #{sname} 
		</if>
		<if test="type != null">
			AND type = #{type} 
		</if>
		<if test="hasChild != null">
			AND has_child = #{hasChild} 
		</if>
		<if test="level != null">
			AND level = #{level} 
		</if>
		<if test="levelMin != null">
			<![CDATA[				
			AND level >= #{levelMin} 
			]]> 
		</if>
		<if test="levelMax != null">
			<![CDATA[				
			AND level < #{levelMax} 
			]]> 
		</if>
		<if test="sortno != null">
			AND sortno = #{sortno} 
		</if>
		<if test="sortnoMin != null">
			<![CDATA[				
			AND sortno >= #{sortnoMin} 
			]]> 
		</if>
		<if test="sortnoMax != null">
			<![CDATA[				
			AND sortno < #{sortnoMax} 
			]]> 
		</if>
		<if test="parentId != null">
			AND parentId = #{parentId} 
		</if>
		<if test="parentNid != null">
			AND parent_nid = #{parentNid} 
		</if>
		<if test="parentSid != null">
			AND parent_sid = #{parentSid} 
		</if>
		<if test="description != null">
			AND description LIKE "%"#{description}"%" 
		</if>
		<if test="status != null">
			AND status = #{status} 
		</if>
		<if test="statusMin != null">
			<![CDATA[				
			AND status >= #{statusMin} 
			]]> 
		</if>
		<if test="statusMax != null">
			<![CDATA[				
			AND status < #{statusMax} 
			]]> 
		</if>
	</sql>
	
	
	
	<sql id="removeCommon">
		<include refid="queryCommon"/>
		<if test="true">
			<![CDATA[				
			AND status < 0  
			]]> 
		</if>
	</sql>
	
	
	
	<sql id="updateFields">
		<if test="_code != null">
			code = #{_code} ,
		</if>
		<if test="_name != null">
			name = #{_name} ,
		</if>
		<if test="_scode != null">
			scode = #{_scode} ,
		</if>
		<if test="_sname != null">
			sname = #{_sname} ,
		</if>
		<if test="_type != null">
			type = #{_type} ,
		</if>
		<if test="_hasChild != null">
			has_child = #{_hasChild} ,
		</if>
		<if test="_level != null">
			level = #{_level} ,
		</if>
		<if test="_sortno != null">
			sortno = #{_sortno} ,
		</if>
		<if test="_parentId != null">
			parent_id = #{_parentId} ,
		</if>
		<if test="_parentNid != null">
			parent_nid = #{_parentNid} ,
		</if>
		<if test="_parentSid != null">
			parent_sid = #{_parentSid} ,
		</if>
		<if test="_description != null">
			description = #{_description} ,
		</if>
		<if test="_status != null">
			status = #{_status} , 
		</if>
	</sql>
	



	<insert id="add" parameterType="cn.com.iherpai.core.storage.mybatis.orm.DictGroup">
		INSERT INTO dict_group(
			nid, sid, 
			code, name, scode, sname, type, has_child, level, sortno,
			parent_id, parent_nid, parent_sid,  
			description, create_time, status
		) VALUES (
			#{nid}, #{sid},
			#{code}, #{name}, #{scode}, #{sname}, #{type}, #{hasChild}, #{level}, #{sortno},
			#{parentId}, #{parentNid}, #{parentSid}, 
			#{description}, #{createTime}, #{status}
		)
	</insert>
	
	
	
	<delete id="remove" parameterType="java.util.HashMap">
		DELETE 
		FROM 
			dict_group 
		WHERE
			1=1 AND 
			${conditions}
	</delete>
	
	
	
	<delete id="removeBySid" parameterType="java.util.HashMap">
		DELETE 
		FROM 
			dict_group 
		<where>		
			sid = #{sid}
			AND
			parentSid = #{parentSid}
			AND
			status = 0
			<include refid="queryCommon"/>
			<if test="true">
				<![CDATA[				
				AND status = 0  
				]]> 
			</if>
		</where>
	</delete>
	
	
	
	<delete id="removeByCondi" parameterType="java.util.HashMap">
		DELETE 
		FROM 
			dict_group 
		<where>
			<include refid="queryCommon"/>
			<if test="true">
				<![CDATA[				
				AND status = 0  
				]]> 
			</if>
		</where>
	</delete>
	
	
	
	<update id="update" parameterType="java.util.HashMap">
		UPDATE 
			dict_group 
		<set>
			<include refid="updateFields"/>
		</set>
		<where>
			<include refid="queryCommon"/>
		</where>
	</update>
	
	
	
	<select id="get" parameterType="java.util.HashMap" resultMap="DictGroupFldsDefault">
		SELECT 
			${fields} 
		FROM 
			dict_group 
		<where>
			<include refid="queryCommon"/>
		</where>
	</select>
	
	
	
	<select id="getCount" parameterType="java.util.HashMap" resultType="int">
		SELECT 
			count(sid)
		FROM 
			dict_group 
		<where>
			<include refid="queryCommon"/>
		</where>
	</select>
	
	
	<select id="list" parameterType="java.util.HashMap" resultMap="DictGroupFldsDefault">
		SELECT 
			${fields}
		FROM
			dict_group
		WHERE 
			sid >=
			(	
				SELECT sid 
				FROM dict_group 
				<where>
					<include refid="queryCommon"/>
				</where> 
				LIMIT
					#{pageOff}, 1
			)
		LIMIT 
			#{pageSize}
	</select>
	
	
	
</mapper>